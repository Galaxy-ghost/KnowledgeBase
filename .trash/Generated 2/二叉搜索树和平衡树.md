
Source: [[PDFs/二叉搜索树和平衡树.pdf]]

---

###### Page 1

### 二叉搜索树和平衡树 1. 二叉搜索树（BST）

二叉搜索树(Binary Search Tree)，也有称之为二叉排序树、二叉查找树 1.1 定义和性质 在二叉树的基础上，增加了几个规则约束：

![二叉搜索树和平衡树_1_85](Generated/images/二叉搜索树和平衡树_1_85.png)

如果他的左⼦树不空，则左⼦树上所有结点的值均⼩于它的根结点的值。 若它的右⼦树不空，则右⼦树上所有结点的值均⼤于它的根结点的值。 它的左、右树⼜分为二叉排序树。

### 1.2 构建二叉排序树

### 1.3 二叉搜索树的优势

二叉排序树的中序遍历，就是一个从⼩到⼤排好序的序列，但是查找时，完全没有必要先进行中序遍历生成一个有序 的数组，再二分查找，直接根据二叉搜索树的约束直接操作。 查找时间最坏情况就是树的深度 二叉搜索树的查找逻辑，可以写成递归的思路和非递归思路。 BiTree SearchBST(BiTree T,KeyType key){

//如果递归过程中 T 为空，则查找结果，返回NULL；或者查找成功，返回指向该关键字的指针  if (!T || key==T->data) {  return T;  }else if(key<T->data){  //递归遍历其左孩⼦  return SearchBST(T->lchild, key);  }else{

假设有无序序列如下：

8 3 10 1 6 14 4 7 13


---

###### Page 2

//递归遍历其右孩⼦  return SearchBST(T->rchild, key);  } } 1.4 二叉搜索树的实现 1.4.1 二叉搜索树的插入操作

算法思想

插入的新节点都是在叶节点位置 寻找插入节点的位置，建立父节点和新节点的左右关系 是一种递归思想 递归思路

涉及到前后节点，⼦问题就是返回新节点，上一个状态就是左⼦树还是右⼦树来接收 递归核心代码 1.4.2 查找某一节点下的最⼤或最⼩值

算法思想

比当前节点⼩的值，一定放在他的左⼦树上，那么一直往左查找最左边的节点，就是最⼩值 比当前节点⼤的值，一定放在他的右⼦树上，那么一直往右查找最左边的节点，就是最⼤值 算法实现 1.4.2 二叉搜索树的删除操作

算法分析

删除节点，共有三种可能性： 叶⼦结点

叶⼦结点从二叉搜索树中移除后，并不影响其他结点的排列规则，直接删除 度为1的结点

该节点缺失左⼦树或右⼦树，当去掉这个节点后，剩余的左⼦树和右⼦树满足二叉搜索树的要求 矛盾在于删除的这个节点，属于父节点的左边还是右边，那么剩余的左⼦树或右⼦树仍然满足父节点的左右属性，接 入这个父节点就可以 度为2的结点

### 假设要删除的节点A，他的后结点，既有⼤于他的也有⼩于他的，现在就是要选择一个节点B，满足左边节点都比B ⼩，右边节点都比B⼤。 其实就是中序遍历时，前一个节点或后一个节点来替换这个节点，然后删除前一个或后一个节点 先找到这个待删除结点的前一个或后一个，替换待删除结点 1234567 1234457 这个时候删除4就可以，而4一定是叶⼦结点，就⼜回到了叶⼦节点删除的逻辑

递归思路 二叉搜索树的删除请情况

删除叶⼦节点，直接删除 删除的节点有一个叶⼦节点，用叫⼦节点来替代 删除的节点有两个⼦节点


---

###### Page 3

### 找到前驱节点，复制前驱节点的值覆盖掉预备删除的节点，然后删除前驱节点 找到后继节点，复制后继节点的值覆盖掉预备删除的节点，然后删除后继节点 2. 二叉平衡树（AVL）

### 2.1 二叉搜索树的问题

二叉搜索树的查找效率取决于树的⾼度，因此保持树的⾼度最⼩，即可保证树的查找效率。 二叉搜索树会退化成单链表，搜索效率降低为O(n)

### 2.2 平衡因⼦

### 2.3 平衡树失衡情况分析 2.3.1 左旋

当加入一个新节点后，右边的⾼度增加，导致失衡 /* 左旋操作

\* px  * |  * x  * / \  * lx y  * / \  * ly ry  * */ AVLNode *leftRotate(AVLNode *x); 2.3.2 右旋

/* 右旋操作  * py  * |  * y  * / \  * x ry

AVL树是最早被发明的⾃平衡二叉查找树。在AVL树中，任一节点对应的两棵⼦树的最⼤⾼度差的绝对值为1，因 此它也被称为⾼度平衡树。AVL树是根据它的发明者G.M. Adelson-Velsky和E.M. Landis命名的。

查找、插入和删除在平均和最坏情况下的时间复杂度都是 O(logn）。 增加和删除元素的操作则可能需要借由一次 或多次树旋转，以实现树的重新平衡。

二叉搜索树一定程度上可以提⾼搜索效率，但是当原序列有序时，例如序列 A = {1，2，3，4， 5，6}，构造二叉 搜索树如图。依据此序列构造的二叉搜索树为右斜树，同时二叉树退化成单链表，搜索效率降低为 O(n)。

二叉搜索树的查找效率取决于树的⾼度，因此保持树的⾼度最⼩，即可保证树的查找效率。

左⼦树与右⼦树的⾼度差即为该节点的平衡因⼦（BF,Balance Factor） 平衡二叉树中不存在平衡因⼦⼤于 1 的节点。 在一棵平衡二叉树中，节点的平衡因⼦只能取 0 、1 或者 -1 ，分别对应着左右⼦树等⾼，左⼦树比较⾼，右⼦树比较 ⾼。


---

###### Page 4

\* / \  * lx rx  * */ AVLNode *rightRotate(AVLNode *y); 2.3.3 LL、RR、LR、RL

### LL ：失衡节点左边⾼，新插入节点是在失衡节点左孩⼦的左边。直接对失衡节点进行右旋即可。 RR：失衡节点右边⾼，新插入节点是在失衡节点右孩⼦的右边。直接对失衡节点进行左旋即可。 LR：失衡节点左边⾼，新插入节点是在失衡节点左孩⼦的右边。先对左孩⼦进行左旋，再对失衡节点进行右旋。 RL：失衡节点右边⾼，新插入节点是在失衡节点右孩⼦的左边。先对右孩⼦进行右旋，再对失衡节点进行左旋。 2.4 平衡二叉树的插入操作

算法思路

先找到要插入的节点位置，插入新节点 更新平衡因⼦，根据平衡因⼦⼩于-1和⼤于1的情况进行讨论 2.5平衡二叉树的删除操作

算法思路

依据二叉排序树的删除特点，依然按照3种条件进行删除，保证最后删除的都是叶⼦节点即可。 节点删除后，依次对节点进行平衡因⼦检查，若发现某节点不平衡，按照平衡调节法进行调节。


### Footnotes
