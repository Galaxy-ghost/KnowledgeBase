## 线索二叉树

### 背景介绍

现有一棵结点数目为n的二叉树，采⽤二叉链表的形式存储，对于每个结点均有指向左右孩子的两个指针域。

结点为n的二叉树一共有n-1条有效分支路径。那么，则二叉链表中存在

2n - ( n-1 ) = n + 1个 空指针域

那么，这些空指针造成了空间浪费。

---

### 线索化

-   将某结点的空指针域指向该结点的前驱后继，定义规则如下：
    

-   若结点的左子树为空，则该结点的左孩子指针指向其前驱结点。
    
-   若结点的右子树为空，则该结点的右孩子指针指向其后继结点。
    

-   这种指向前驱和后继的指针称为线索。将一棵普通二叉树以某种次序遍历，并添加线索的过程称为线索化。
    

![img](https://uploader.shimo.im/f/LYfXHwZWwB57INE5.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2ODE2MTgxNzksImZpbGVHVUlEIjoiMWxxN01teThZclV6d0FldyIsImlhdCI6MTY4MTYxNzg3OSwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4MzU0MjM0M30.w6LIuB1Qj8TvcSu4eGWIZzYh5d8sFadYCBmFz6g_sps)

-   前驱与后继指的是在中序遍历中的顺序
    

---

### 线索化的改进

-   可以将一棵二叉树线索化为一棵线索二叉树，那么新的问题产⽣了。我们如何区分一个结点的 lchild指针是指向左孩子还是前驱结点呢
    
-   为了解决这一问题，现需要添加标志位ltag，rtag。并定义规则如下：
    

-   ltag为0时，指向左孩子，为1时指向前驱
    
-   rtag为0时，指向右孩子，为1时指向后继
    

![img](https://uploader.shimo.im/f/7UOgAiGd0i7MTHu9.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2ODE2MTgxNzksImZpbGVHVUlEIjoiMWxxN01teThZclV6d0FldyIsImlhdCI6MTY4MTYxNzg3OSwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4MzU0MjM0M30.w6LIuB1Qj8TvcSu4eGWIZzYh5d8sFadYCBmFz6g_sps)

### 线索化的实现

![img](https://uploader.shimo.im/f/H2ghFUNFEQdJQHxY.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2ODE2MTgxNzksImZpbGVHVUlEIjoiMWxxN01teThZclV6d0FldyIsImlhdCI6MTY4MTYxNzg3OSwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4MzU0MjM0M30.w6LIuB1Qj8TvcSu4eGWIZzYh5d8sFadYCBmFz6g_sps)

---

## 二叉树非递归深度遍历

### 先序非递归算法

1.  先压入根节点
    
2.  弹出元素，访问
    
3.  将元素的右边先压栈，然后左边再压栈
    

---

### 中序非递归算法

1.  从根节点，整条左边进栈
    
2.  从栈中弹出节点访问，然后以这个节点的右孩子为新节点
    
3.  再次安排整条左边进栈，再弹栈
    

---

### 后序非递归算法

1.  第一个栈压入根节点后，弹出到第二个栈，这样根节点就变成最后输出
    
2.  后序遍历的倒数第二个元素应该是根节点的右孩子，所以辅助栈先左后右
    
3.  辅助栈弹出元素，放入到第二个栈，这个节点先左后右放入第一个栈
    

---

### 二叉树的实现

![img](https://uploader.shimo.im/f/5SJJuuZY3EcCAlfN.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2ODE2MTgxNzksImZpbGVHVUlEIjoiMWxxN01teThZclV6d0FldyIsImlhdCI6MTY4MTYxNzg3OSwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4MzU0MjM0M30.w6LIuB1Qj8TvcSu4eGWIZzYh5d8sFadYCBmFz6g_sps)